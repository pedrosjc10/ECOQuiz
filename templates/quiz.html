<!DOCTYPE html>
<html>
<head>
    <title>EcoQuiz üå±</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <div class="quiz-container">
        <h1>EcoQuiz ‚Äì Sustentabilidade üåç</h1>
        <!-- O formul√°rio envia o nome do usu√°rio e as respostas -->
        <form id="quiz-form" method="post" action="/submit">
            <!-- Este campo oculto envia o nome do usu√°rio -->
            <input type="hidden" name="name" value="{{ name }}">
            
            {% for q in questions %}
                <div class="card question-card">
                    <p><b>{{ loop.index }}. {{ q.question }}</b></p>
                    {% for opt in q.options %}
                        <div class="option-container">
                            <!-- O 'name' √© o mesmo para todas as op√ß√µes de uma pergunta espec√≠fica -->
                            <input type="radio" id="q{{ loop.index }}-opt{{ loop.index }}" name="q{{ loop.index }}" value="{{ opt }}" required>
                            <label for="q{{ loop.index }}-opt{{ loop.index }}">{{ opt }}</label>
                        </div>
                    {% endfor %}
                    <!-- Este campo oculto armazena a resposta correta -->
                    <input type="hidden" name="correct{{ loop.index }}" value="{{ q.answer }}">
                </div>
            {% endfor %}
            <button type="submit" class="btn submit-btn">Finalizar Quiz</button>
        </form>
    </div>
    
    <script>
        // Garante que apenas uma op√ß√£o seja selecionada por pergunta
        document.querySelectorAll('input[type="radio"]').forEach(function(radio) {
            radio.addEventListener('change', function() {
                // Remove a sele√ß√£o de outras op√ß√µes da mesma pergunta
                const questionName = this.name;
                document.querySelectorAll(`input[name="${questionName}"]`).forEach(function(otherRadio) {
                    if (otherRadio !== radio) {
                        otherRadio.checked = false;
                    }
                });
            });
        });
        
        // Valida√ß√£o antes de enviar o formul√°rio
        document.getElementById('quiz-form').addEventListener('submit', function(e) {
            const questions = document.querySelectorAll('.question-card');
            let allAnswered = true;
            
            questions.forEach(function(question, index) {
                const selectedOption = question.querySelector('input[type="radio"]:checked');
                if (!selectedOption) {
                    allAnswered = false;
                    alert(`Por favor, responda a pergunta ${index + 1}`);
                    e.preventDefault();
                    return false;
                }
            });
            
            if (allAnswered) {
                alert('Quiz enviado com sucesso! Verificando suas respostas...');
            }
        });
    </script>
</body>
</html>
